<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å°ˆæ¥­å…«å­—å‘½ç›¤ | ç·šä¸Šæ’ç›¤èˆ‡é‹å‹¢è§£æ</title>
    <script src="https://cdn.jsdelivr.net/npm/lunar-javascript@1.6.12/lunar.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        body { font-family: "Microsoft JhengHei", "PingFang TC", Arial, sans-serif; background-color: #f0f2f5; display: flex; justify-content: center; padding: 20px; line-height: 1.6; padding-bottom: 80px; }
        .container { background: white; padding: 30px; border-radius: 15px; box-shadow: 0 4px 20px rgba(0,0,0,0.08); width: 100%; max-width: 700px; position: relative; }
        
        h1 { text-align: center; color: #2c3e50; margin-bottom: 10px; }
        .subtitle { text-align: center; color: #7f8c8d; font-size: 14px; margin-bottom: 30px; }

        .input-group { margin-bottom: 15px; }
        label { display: block; margin-bottom: 5px; font-weight: bold; color: #34495e; }
        input { width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 8px; box-sizing: border-box; font-size: 16px; }
        
        /* æŸ¥è©¢æŒ‰éˆ• */
        .btn-calc { width: 100%; padding: 14px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none; border-radius: 8px; font-size: 18px; font-weight: bold; cursor: pointer; transition: 0.3s; margin-top: 10px; box-shadow: 0 4px 10px rgba(118, 75, 162, 0.3); }
        .btn-calc:hover { opacity: 0.9; transform: translateY(-2px); }
        
        .result-box { margin-top: 30px; display: none; animation: fadeIn 0.5s; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        /* è¡¨æ ¼æ¨£å¼ */
        .chart-table { width: 100%; border-collapse: separate; border-spacing: 4px; margin-bottom: 25px; text-align: center; table-layout: fixed; }
        .chart-table th { background: #ecf0f1; padding: 8px 2px; border-radius: 5px; color: #7f8c8d; font-size: 13px; }
        .chart-table td { background: #fff; border: 2px solid #ecf0f1; border-radius: 8px; padding: 10px 2px; vertical-align: top; }
        
        .gan-zhi { font-size: 24px; font-weight: bold; display: block; margin: 5px 0; }
        .god-label-top { font-size: 12px; color: #555; display: block; background: #fafafa; padding: 4px 0; border-radius: 4px; margin-bottom: 5px; font-weight: bold; }
        .hidden-stems-box { font-size: 12px; text-align: center; margin-top: 5px; color: #666; }
        .main-qi { color: #333; font-weight: bold; display: block; margin-bottom: 2px; font-size: 13px; }
        .sub-qi { color: #999; display: block; font-size: 11px; transform: scale(0.9); }
        .day-master-bg { border-color: #f1c40f !important; background-color: #fffcf0 !important; }

        /* äº”è¡Œé¡è‰² */
        .wood { color: #27ae60; } .fire { color: #c0392b; } .earth { color: #d35400; } .metal { color: #f39c12; } .water { color: #2980b9; }

        .analysis-card { background: #f8f9fa; padding: 20px; border-left: 5px solid #764ba2; border-radius: 5px; margin-bottom: 20px; }
        .analysis-card h4 { margin-top: 0; color: #764ba2; margin-bottom: 10px;}

        /* è¡ŒéŠ·å°æµå€å¡Š */
        .marketing-box { background: #fff8e1; border: 1px solid #ffe0b2; padding: 20px; border-radius: 10px; margin-top: 30px; text-align: center; }
        .marketing-title { font-weight: bold; color: #d35400; font-size: 18px; margin-bottom: 10px; }
        .marketing-text { font-size: 14px; color: #555; margin-bottom: 15px; text-align: left; }
        
        .social-buttons { display: flex; gap: 10px; justify-content: center; margin-top: 15px; }
        .btn-social { flex: 1; padding: 12px; border-radius: 8px; text-decoration: none; font-weight: bold; display: flex; align-items: center; justify-content: center; gap: 8px; transition: 0.3s; color: white; font-size: 15px; }
        .btn-line { background-color: #06c755; }
        .btn-line:hover { background-color: #05b34c; }
        .btn-ig { background: linear-gradient(45deg, #f09433 0%, #e6683c 25%, #dc2743 50%, #cc2366 75%, #bc1888 100%); }
        .btn-ig:hover { opacity: 0.9; }

        .footer { text-align: center; margin-top: 30px; font-size: 12px; color: #aaa; }
    </style>
</head>
<body>

<div class="container">
    <h1>ğŸ”® å…«å­—å‘½ç›¤ Pro</h1>
    <div class="subtitle">è¼¸å…¥ç”Ÿæ—¥ï¼Œæ­é–‹æ‚¨çš„å‘½ç†å¯†ç¢¼</div>
    
    <div class="input-group">
        <label>å‡ºç”Ÿæ—¥æœŸ (åœ‹æ›†)</label>
        <input type="date" id="birthDate">
    </div>
    
    <div class="input-group">
        <label>å‡ºç”Ÿæ™‚é–“</label>
        <input type="time" id="birthTime" value="12:00">
    </div>

    <button class="btn-calc" onclick="calculateBazi()">æŸ¥çœ‹å‘½ç›¤èˆ‡è§£æ</button>

    <div id="result" class="result-box">
        <hr style="border: 0; border-top: 1px solid #eee; margin: 25px 0;">
        <h2>ğŸ—“ï¸ æ‚¨çš„å…«å­—å‘½ç›¤</h2>
        
        <table class="chart-table">
            <thead>
                <tr>
                    <th>å¹´æŸ± (ç¥–ä¸Š)</th>
                    <th>æœˆæŸ± (äº‹æ¥­)</th>
                    <th>æ—¥æŸ± (æœ¬å‘½)</th>
                    <th>æ™‚æŸ± (å­å¥³)</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><span id="yearGod" class="god-label-top"></span></td>
                    <td><span id="monthGod" class="god-label-top"></span></td>
                    <td><span class="god-label-top" style="background:#f1c40f; color:white;">å…ƒç¥</span></td>
                    <td><span id="hourGod" class="god-label-top"></span></td>
                </tr>
                <tr>
                    <td id="yearGan"></td>
                    <td id="monthGan"></td>
                    <td id="dayGan" class="day-master-bg"></td>
                    <td id="hourGan"></td>
                </tr>
                <tr>
                    <td id="yearZhi"></td>
                    <td id="monthZhi"></td>
                    <td id="dayZhi" class="day-master-bg"></td>
                    <td id="hourZhi"></td>
                </tr>
                <tr>
                    <td id="yearHidden"></td>
                    <td id="monthHidden"></td>
                    <td id="dayHidden"></td>
                    <td id="hourHidden"></td>
                </tr>
            </tbody>
        </table>

        <div class="analysis-card">
            <h4>ğŸ‘¤ æœ¬å‘½æ€§æ ¼ (æ—¥ä¸»)</h4>
            <p><strong>æ‚¨çš„æ ¸å¿ƒæœ¬è³ªï¼š</strong> <span id="dayMasterDesc"></span></p>
            <p id="personalityText" style="font-size: 15px; color: #444;"></p>
        </div>

        <div class="analysis-card">
            <h4>ğŸ’¼ æ½›åœ¨æ ¼å±€ (æœˆä»¤)</h4>
            <p><strong>èƒ½é‡ä¸­å¿ƒï¼š</strong> <span id="patternType"></span></p>
            <p id="patternDesc" style="font-size: 15px; color: #444;"></p>
        </div>

        <div class="marketing-box">
            <div class="marketing-title">âš ï¸ é›»è…¦æ’ç›¤åƒ…ä¾›åƒè€ƒï¼Œå‘½å¥½æ›´éœ€é‹åŠ©</div>
            <div class="marketing-text">
                <p>ä»¥ä¸Šåˆ†æåƒ…åŸºæ–¼ã€Œå…ˆå¤©å‘½æ ¼ã€ï¼Œä½†äººç”Ÿçš„éš›é‡å¾€å¾€å–æ±ºæ–¼<strong>ã€Œå¤§é‹ã€èˆ‡ã€Œæµå¹´ã€</strong>çš„é…åˆã€‚</p>
                <ul style="padding-left: 20px; margin: 10px 0;">
                    <li>é€™çœŸçš„æ˜¯é©åˆè½‰è·ã€å‰µæ¥­çš„å¹´ä»½å—ï¼Ÿ</li>
                    <li>ç›®å‰é‡åˆ°çš„æ„Ÿæƒ…å°è±¡æ˜¯æ­£ç·£é‚„æ˜¯çˆ›æ¡ƒèŠ±ï¼Ÿ</li>
                    <li>å‘½ç›¤ä¸­çš„ç…æ°£è©²å¦‚ä½•åŒ–è§£ï¼Ÿ</li>
                </ul>
                <p>è‹¥æ‚¨å°æœªä¾†æ„Ÿåˆ°è¿·æƒ˜ï¼Œæˆ–æƒ³æ·±å…¥äº†è§£å¦‚ä½•<strong>è¶¨å‰é¿å‡¶</strong>ï¼Œæ­¡è¿è¯ç¹«æˆ‘é€²è¡Œå®Œæ•´çš„ä¸€å°ä¸€è«®è©¢ã€‚</p>
            </div>
            
            <div class="social-buttons">
                <a href="https://line.me/ti/p/ä½ çš„ID" target="_blank" class="btn-social btn-line">
                    <i class="fab fa-line"></i> åŠ  LINE è«®è©¢
                </a>
                <a href="https://instagram.com/ä½ çš„ID" target="_blank" class="btn-social btn-ig">
                    <i class="fab fa-instagram"></i> è¿½è¹¤ IG
                </a>
            </div>
        </div>
    </div>
    
    <div class="footer">
        &copy; 2024 å°ˆæ¥­å…«å­—æ’ç›¤ç³»çµ± | åƒ…ä¾›å­¸è¡“äº¤æµåƒè€ƒ
    </div>
</div>

<script>
    // === ç¹é«”ä¸­æ–‡è½‰æ›æ ¸å¿ƒå·¥å…· ===
    // å°‡ç°¡é«”è¼¸å‡ºçš„ "è´¢ã€ä¼¤ã€æ€" å¼·åˆ¶è½‰ç‚º "è²¡ã€å‚·ã€æ®º"
    function toTraditional(str) {
        if (!str) return '';
        return str.toString()
            .replace(/è´¢/g, 'è²¡')
            .replace(/ä¼¤/g, 'å‚·')
            .replace(/æ€/g, 'æ®º')
            .replace(/æ­/g, 'æ¢Ÿ')
            .replace(/ä¸‘/g, 'ä¸‘'); // å…«å­—ä¸­ "ä¸‘" æ˜¯åœ°æ”¯ï¼Œä¸ç”¨è½‰æˆ "é†œ"
    }

    const getElementClass = (char) => {
        const mapping = {
            'ç”²': 'wood', 'ä¹™': 'wood', 'å¯…': 'wood', 'å¯': 'wood',
            'ä¸™': 'fire', 'ä¸': 'fire', 'å·³': 'fire', 'åˆ': 'fire',
            'æˆŠ': 'earth', 'å·±': 'earth', 'è¾°': 'earth', 'æˆŒ': 'earth', 'ä¸‘': 'earth', 'æœª': 'earth',
            'åºš': 'metal', 'è¾›': 'metal', 'ç”³': 'metal', 'é…‰': 'metal',
            'å£¬': 'water', 'ç™¸': 'water', 'äº¥': 'water', 'å­': 'water'
        };
        return mapping[char] || '';
    };

    const renderChar = (char) => {
        // ç¢ºä¿å¤©å¹²åœ°æ”¯ä¹Ÿæ˜¯ç¹é«”ï¼ˆé›–ç„¶åŸºæœ¬å­—æ²’å·®ï¼Œä½†ç‚ºäº†ä¿éšªï¼‰
        const tradChar = toTraditional(char);
        return `<span class="gan-zhi ${getElementClass(tradChar)}">${tradChar}</span>`;
    };

    const renderHiddenStems = (stemsArray) => {
        if (!stemsArray || stemsArray.length === 0) return '';
        let html = '<div class="hidden-stems-box">';
        
        // é€™è£¡åŠ ä¸Š toTraditional ç¢ºä¿è—å¹²åç¥é¡¯ç¤ºç‚ºç¹é«”
        html += `<span class="main-qi">${toTraditional(stemsArray[0])}</span>`;
        if (stemsArray.length > 1) {
            for (let i = 1; i < stemsArray.length; i++) {
                html += `<span class="sub-qi">${toTraditional(stemsArray[i])}</span>`;
            }
        }
        html += '</div>';
        return html;
    };

    const personalities = {
        'ç”²': 'æ‚¨æ˜¯ç”²æœ¨äººã€‚åƒå¤§æ¨¹ä¸€æ¨£ï¼Œæ­£ç›´ã€ä»æ…ˆä¸”å‘ä¸Šç”Ÿé•·ã€‚æ‚¨ä¸å–œæ­¡è¢«å±ˆæœï¼Œæœ‰é ˜è¢–é¢¨ç¯„ï¼Œä½†æœ‰æ™‚è¼ƒç‚ºå›ºåŸ·ã€‚è‹¥å‘½ä¸­ç¼ºç«ï¼Œå®¹æ˜“æ‡·æ‰ä¸é‡ï¼›è‹¥ç¼ºåœŸï¼Œå‰‡æ ¹åŸºä¸ç©©ã€‚',
        'ä¹™': 'æ‚¨æ˜¯ä¹™æœ¨äººã€‚åƒèŠ±è‰ä¸€æ¨£ï¼Œé©æ‡‰åŠ›å¼·ï¼Œèº«æ®µæŸ”è»Ÿã€‚æ‚¨å–„æ–¼äº¤éš›ï¼Œå¿ƒæ€ç´°è†©ï¼Œå…§åœ¨ç”Ÿå‘½åŠ›æ¥µå¼·ã€‚æ“…é•·ä»¥æŸ”å…‹å‰›ï¼Œåœ¨è¤‡é›œçš„ç’°å¢ƒä¸­å¾€å¾€èƒ½ç”Ÿå­˜åˆ°æœ€å¾Œã€‚',
        'ä¸™': 'æ‚¨æ˜¯ä¸™ç«äººã€‚åƒå¤ªé™½ä¸€æ¨£ç†±æƒ…é–‹æœ—ï¼Œä¸æ‹˜å°ç¯€ã€‚æ‚¨æ¨‚æ–¼åŠ©äººï¼Œè—ä¸ä½è©±ï¼Œæƒ…ç·’ä¾†å¾—å¿«å»å¾—ä¹Ÿå¿«ã€‚æ‚¨çš„å‡ºç¾ç¸½èƒ½é©…æ•£é™°éœ¾ï¼Œä½†è¦æ³¨æ„é¿å…éåº¦ç†±æƒ…ç¼å‚·ä»–äººã€‚',
        'ä¸': 'æ‚¨æ˜¯ä¸ç«äººã€‚åƒç‡­ç«èˆ¬æº«æš–ï¼Œå¿ƒæ€ç¸å¯†ã€‚æ‚¨å¤–è¡¨æ²ˆç©©ï¼Œå…§å¿ƒå……æ»¿ç†±æƒ…ï¼Œæ´å¯ŸåŠ›å¼·ã€‚æ‚¨æ¯”ä¸™ç«æ›´å…·æœ‰çŠ§ç‰²å¥‰ç»çš„ç²¾ç¥ï¼Œå¾€å¾€æ˜¯åœ˜éšŠä¸­é»˜é»˜ä»˜å‡ºçš„æ™ºå›Šã€‚',
        'æˆŠ': 'æ‚¨æ˜¯æˆŠåœŸäººã€‚åƒé«˜å±±ä¸€æ¨£ç©©é‡åšå¯¦ï¼Œè¬›ä¿¡ç”¨ã€‚æ‚¨çµ¦äººå®‰å…¨æ„Ÿï¼Œåšäº‹æŒ‰éƒ¨å°±ç­ï¼Œä¸å–œæ­¡è®Šå‹•ã€‚è™½ç„¶åæ‡‰å¯èƒ½ä¸å¿«ï¼Œä½†æ‚¨çš„æ¯…åŠ›èˆ‡åŒ…å®¹åŠ›æ˜¯åå¤©å¹²ä¸­æœ€å¼·çš„ã€‚',
        'å·±': 'æ‚¨æ˜¯å·±åœŸäººã€‚åƒç”°åœ’ä¹‹åœŸï¼ŒåŒ…å®¹åŠ›å¼·ï¼Œå¤šæ‰å¤šè—ã€‚æ‚¨å…§æ–‚è¬¹æ…ï¼Œèƒ½å­•è‚²è¬ç‰©ï¼Œå¾ˆæœ‰åŒç†å¿ƒã€‚ä½†æœ‰æ™‚æœƒæƒ³å¤ªå¤šã€å„ªæŸ”å¯¡æ–·ï¼Œéœ€è¦é€éå­¸ç¿’ä¾†å¢åŠ è‡ªä¿¡ã€‚',
        'åºš': 'æ‚¨æ˜¯åºšé‡‘äººã€‚åƒåˆ€åŠä¸€æ¨£å‰›æ¯…æœæ–·ï¼Œè¬›ç¾©æ°£ã€‚æ‚¨æ˜¯éåˆ†æ˜ï¼ŒåŸ·è¡ŒåŠ›å¼·ï¼Œä¸å–œæ­¡æ‹–æ³¥å¸¶æ°´ã€‚ç¶“éç£¨ç·´ï¼ˆç«ç…‰ï¼‰çš„åºšé‡‘èƒ½æˆå¤§å™¨ï¼Œè‹¥éåº¦ä¿è­·å‰‡å®¹æ˜“æˆç‚ºé ‘éµã€‚',
        'è¾›': 'æ‚¨æ˜¯è¾›é‡‘äººã€‚åƒç å¯¶ä¸€æ¨£ç²¾ç·»ï¼Œé‡è¦–é¢å­èˆ‡è³ªæ„Ÿã€‚æ‚¨æ„Ÿå—åŠ›æ•éŠ³ï¼Œå£æ‰ä½³ï¼Œæœ‰ç¨ç‰¹çš„å¯©ç¾è§€ã€‚æ‚¨å¸Œæœ›è¢«å‘µè­·å’Œæ¬£è³ï¼Œå—ä¸äº†ç²—ç³™çš„å°å¾…æˆ–æ‰¹è©•ã€‚',
        'å£¬': 'æ‚¨æ˜¯å£¬æ°´äººã€‚åƒå¤§æµ·ä¸€æ¨£å¥”æ”¾ï¼Œè°æ˜ä¸”åæ‡‰å¿«ã€‚æ‚¨ä¸å–œæ­¡å—æ‹˜æŸï¼Œé©æ‡‰åŠ›æ¥µå¼·ï¼Œäººè„ˆå»£é—Šã€‚æ‚¨æ“æœ‰å¤§æ™ºæ…§ï¼Œä½†æœ‰æ™‚æµå‹•æ€§å¤ªå¤§ï¼Œéœ€åŸ¹é¤Šå®šæ€§ä»¥å…ä¸€äº‹ç„¡æˆã€‚',
        'ç™¸': 'æ‚¨æ˜¯ç™¸æ°´äººã€‚åƒé›¨éœ²ä¸€æ¨£æº«æŸ”ï¼Œå…§å‘ä¸”å¯Œæƒ³åƒåŠ›ã€‚æ‚¨å¿ƒæ€ç´°è†©ï¼Œç›´è¦ºæ•éŠ³ï¼Œå–„æ–¼è§€å¯Ÿäººå¿ƒã€‚æ‚¨å¤–è¡¨å¹³éœï¼Œå…§å¿ƒå»æƒ…æ„Ÿè±å¯Œï¼Œå®¹æ˜“å› å°äº‹è€Œæ³¢å‹•æƒ…ç·’ã€‚'
    };

    const godPatterns = {
        'æ¯”è‚©': 'å»ºç¥¿æ ¼/æ¯”è‚©å¼·ï¼šæ‚¨æ¸´æœ›ç¨ç«‹è‡ªä¸»ï¼Œä¸å–œæ­¡ä¾è³´ã€‚é©åˆé å°ˆæ¥­æŠ€èƒ½æˆ–åˆå¤¥å‰µæ¥­ï¼Œä½†éœ€æ³¨æ„äººéš›ç«¶çˆ­èˆ‡éŒ¢è²¡åˆ†å¥ªçš„å•é¡Œã€‚',
        'åŠ«è²¡': 'ç¾Šåˆƒ/åŠ«è²¡å¼·ï¼šæ‚¨é‡å¿ƒå‹ƒå‹ƒï¼Œç¤¾äº¤æ‰‹è…•é«˜æ˜ï¼Œæ˜¯å¤©ç”Ÿçš„æ¥­å‹™å¥½æ‰‹ã€‚ä½†æ€§æ ¼ä¸­æœ‰è¡å‹•çš„ä¸€é¢ï¼ŒæŠ•è³‡ç†è²¡éœ€ç‰¹åˆ¥è¬¹æ…ï¼Œä»¥å…å¤§é€²å¤§å‡ºã€‚',
        'é£Ÿç¥': 'é£Ÿç¥æ ¼ï¼šæ‚¨å¤©ç”Ÿæœ‰ç¦æ°£ï¼Œé‡è¦–ç”Ÿæ´»å“å‘³ï¼Œæ€§æ ¼æº«å’Œä¸å–œçˆ­é¬¥ã€‚é©åˆå¾äº‹é¤é£²ã€è—è¡“æˆ–éœ€è¦ç™¼æ®å‰µæ„çš„è¡Œæ¥­ï¼Œä¸€ç”Ÿå¤šè²´äººã€‚',
        'å‚·å®˜': 'å‚·å®˜æ ¼ï¼šæ‚¨æ‰è¯æ´‹æº¢ï¼Œåæ‡‰æ¥µå¿«ï¼Œè¨å­å‚³çµ±æŸç¸›ã€‚é›–ç„¶èƒ½åŠ›å¼·ï¼Œä½†å®¹æ˜“å› ç‚ºå¿ƒç›´å£å¿«è€Œå¾—ç½ªé•·å®˜æˆ–å¦ä¸€åŠï¼Œé©åˆè‡ªç”±æ¥­æˆ–æŠ€è¡“è·ã€‚',
        'æ­£è²¡': 'æ­£è²¡æ ¼ï¼šæ‚¨æ˜¯æ¨™æº–çš„å‹™å¯¦æ´¾ï¼Œåšäº‹è¬¹æ…ï¼Œé‡è¦–å®¶åº­è²¬ä»»ã€‚æ‚¨ä¸å–œæ­¡é«˜é¢¨éšªçš„æŠ•æ©Ÿï¼Œç›¸ä¿¡å‹¤å‹è‡´å¯Œï¼Œé©åˆç©©å®šçš„è·å ´ç™¼å±•ã€‚',
        'åè²¡': 'åè²¡æ ¼ï¼šæ‚¨é‡‘éŒ¢è§€å¿µéˆæ´»ï¼Œæ…·æ…¨è±ªçˆ½ï¼Œå–„æ–¼äº¤éš›ã€‚æ‚¨ä¸å–œæ­¡æ­»å®ˆå›ºå®šè–ªæ°´ï¼Œå…·æœ‰å•†æ¥­é ­è…¦ï¼Œé©åˆç¶“å•†ã€æŠ•è³‡æˆ–æ¥­å‹™æ€§è³ªå·¥ä½œã€‚',
        'æ­£å®˜': 'æ­£å®˜æ ¼ï¼šæ‚¨ç‚ºäººæ­£ç›´ï¼Œè‡ªå¾‹ç”šåš´ï¼Œé‡è¦–åè­½èˆ‡ä¿¡ç”¨ã€‚æ‚¨å…·æœ‰ç®¡ç†æ‰èƒ½ï¼Œé©åˆåœ¨å¤§å‹ä¼æ¥­æˆ–å…¬å®¶æ©Ÿé—œç™¼å±•ï¼Œæ˜¯å…¸å‹çš„é ˜å°äººæ‰ã€‚',
        'ä¸ƒæ®º': 'ä¸ƒæ®ºæ ¼ï¼šæ‚¨å…·æœ‰å¼·çƒˆçš„åŸ·è¡ŒåŠ›èˆ‡æ¬Šå¨æ„Ÿï¼Œä¸ç•è‰±é›£ã€‚æ··äº‚çš„ç’°å¢ƒåè€Œèƒ½æ¿€ç™¼æ‚¨çš„æ½›èƒ½ï¼Œé©åˆè»è­¦ã€æ³•å‹™æˆ–é«˜æŒ‘æˆ°æ€§çš„ç®¡ç†è·ã€‚',
        'æ­£å°': 'æ­£å°æ ¼ï¼šæ‚¨å¿ƒåœ°å–„è‰¯ï¼Œé‡è¦–ç²¾ç¥å±¤é¢ï¼Œæœ‰é•·è¼©ç·£ã€‚æ‚¨å–œæ­¡å­¸ç¿’ï¼Œæ€§æ ¼ä¿å®ˆå®‰éœï¼Œé©åˆæ•™è‚²ã€å­¸è¡“æˆ–æ–‡åŒ–å‡ºç‰ˆç›¸é—œé ˜åŸŸã€‚',
        'åå°': 'åå°æ ¼ï¼šæ‚¨æ€è€ƒç¨ç‰¹ï¼Œç›´è¦ºæ•éŠ³ï¼Œå°ç¥ç¥•å­¸æˆ–å†·é–€çŸ¥è­˜æ„Ÿèˆˆè¶£ã€‚æ‚¨ä¸å–œæ­¡éš¨æ³¢é€æµï¼Œé©åˆå¾äº‹è¨­è¨ˆã€ç ”ç™¼æˆ–èº«å¿ƒéˆç›¸é—œç”¢æ¥­ã€‚'
    };

    function calculateBazi() {
        const dateInput = document.getElementById('birthDate').value;
        const timeInput = document.getElementById('birthTime').value;

        if (!dateInput || !timeInput) {
            alert('è«‹è¼¸å…¥å®Œæ•´çš„å‡ºç”Ÿæ—¥æœŸèˆ‡æ™‚é–“');
            return;
        }

        const [year, month, day] = dateInput.split('-').map(Number);
        const [hour, minute] = timeInput.split(':').map(Number);

        const solar = Solar.fromYmdHms(year, month, day, hour, minute, 0);
        const lunar = solar.getLunar();
        const baZi = lunar.getEightChar();

        document.getElementById('result').style.display = 'block';
        
        // å¤©å¹²åœ°æ”¯æ¸²æŸ“
        document.getElementById('yearGan').innerHTML = renderChar(baZi.getYearGan());
        document.getElementById('yearZhi').innerHTML = renderChar(baZi.getYearZhi());
        document.getElementById('monthGan').innerHTML = renderChar(baZi.getMonthGan());
        document.getElementById('monthZhi').innerHTML = renderChar(baZi.getMonthZhi());
        document.getElementById('dayGan').innerHTML = renderChar(baZi.getDayGan());
        document.getElementById('dayZhi').innerHTML = renderChar(baZi.getDayZhi());
        document.getElementById('hourGan').innerHTML = renderChar(baZi.getTimeGan());
        document.getElementById('hourZhi').innerHTML = renderChar(baZi.getTimeZhi());

        // åç¥æ¸²æŸ“ (åŠ ä¸Š toTraditional è½‰æ›)
        document.getElementById('yearGod').innerText = toTraditional(baZi.getYearShiShenGan());
        document.getElementById('monthGod').innerText = toTraditional(baZi.getMonthShiShenGan());
        document.getElementById('hourGod').innerText = toTraditional(baZi.getTimeShiShenGan());

        // è—å¹²æ¸²æŸ“ (renderHiddenStems å…§éƒ¨å·²ç¶“åŠ ä¸Šäº†è½‰æ›)
        document.getElementById('yearHidden').innerHTML = renderHiddenStems(baZi.getYearShiShenZhi());
        document.getElementById('monthHidden').innerHTML = renderHiddenStems(baZi.getMonthShiShenZhi());
        document.getElementById('dayHidden').innerHTML = renderHiddenStems(baZi.getDayShiShenZhi());
        document.getElementById('hourHidden').innerHTML = renderHiddenStems(baZi.getTimeShiShenZhi());

        // æ–‡å­—è§£æ
        const dayGan = baZi.getDayGan();
        document.getElementById('dayMasterDesc').innerText = `${toTraditional(dayGan)} (${getElementClass(dayGan) === 'wood' ? 'æœ¨' : getElementClass(dayGan) === 'fire' ? 'ç«' : getElementClass(dayGan) === 'earth' ? 'åœŸ' : getElementClass(dayGan) === 'metal' ? 'é‡‘' : 'æ°´'})`;
        document.getElementById('personalityText').innerText = personalities[dayGan];

        // æ ¼å±€è§£æï¼šå…ˆå¾åº«å–å€¼ -> è½‰ç¹é«” -> å†æŸ¥è¡¨
        const rawPattern = baZi.getMonthShiShenZhi()[0]; // å¯èƒ½æ˜¯ "ä¼¤å®˜"
        const patternGod = toTraditional(rawPattern);     // è½‰æˆ "å‚·å®˜"
        
        document.getElementById('patternType').innerText = patternGod;
        document.getElementById('patternDesc').innerText = godPatterns[patternGod] || 'æ ¼å±€è¼ƒç‚ºè¤‡é›œï¼Œèåˆäº†å¤šç¨®ç‰¹è³ªã€‚å»ºè­°é ç´„è©³æ‰¹ä»¥é‡æ¸…æ ¼å±€ã€‚';
        
        setTimeout(() => {
            document.getElementById('result').scrollIntoView({ behavior: 'smooth' });
        }, 100);
    }
</script>

</body>
</html>