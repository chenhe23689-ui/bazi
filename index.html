<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å°ˆæ¥­å…«å­—å‘½ç›¤èˆ‡åç¥è§£æ</title>
    <script src="https://cdn.jsdelivr.net/npm/lunar-javascript@1.6.12/lunar.js"></script>
    <style>
        body { font-family: "Microsoft JhengHei", Arial, sans-serif; background-color: #f0f2f5; display: flex; justify-content: center; padding: 20px; line-height: 1.6; }
        .container { background: white; padding: 30px; border-radius: 15px; box-shadow: 0 4px 20px rgba(0,0,0,0.08); width: 100%; max-width: 700px; }
        h1, h2, h3 { text-align: center; color: #2c3e50; }
        .input-group { margin-bottom: 15px; }
        label { display: block; margin-bottom: 5px; font-weight: bold; color: #34495e; }
        input, select { width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 8px; box-sizing: border-box; font-size: 16px; }
        button { width: 100%; padding: 14px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none; border-radius: 8px; font-size: 18px; font-weight: bold; cursor: pointer; transition: 0.3s; margin-top: 10px; }
        button:hover { opacity: 0.9; transform: translateY(-2px); }
        
        .result-box { margin-top: 30px; display: none; animation: fadeIn 0.5s; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        /* å‘½ç›¤è¡¨æ ¼æ¨£å¼ */
        .chart-table { width: 100%; border-collapse: separate; border-spacing: 5px; margin-bottom: 25px; text-align: center; }
        .chart-table th { background: #ecf0f1; padding: 10px; border-radius: 5px; color: #7f8c8d; font-size: 14px; }
        .chart-table td { background: #fff; border: 2px solid #ecf0f1; border-radius: 8px; padding: 10px 5px; vertical-align: middle; }
        
        /* å…«å­—å¤§å­—èˆ‡åç¥å°å­— */
        .gan-zhi { font-size: 24px; font-weight: bold; display: block; margin: 5px 0; }
        .god-label { font-size: 12px; color: #7f8c8d; display: block; background: #fafafa; padding: 2px; border-radius: 4px; }
        .day-master-bg { border-color: #f1c40f !important; background-color: #fffcf0 !important; }

        /* äº”è¡Œé¡è‰² */
        .wood { color: #27ae60; } /* æœ¨ */
        .fire { color: #c0392b; } /* ç« */
        .earth { color: #d35400; } /* åœŸ */
        .metal { color: #f39c12; } /* é‡‘ */
        .water { color: #2980b9; } /* æ°´ */

        .analysis-card { background: #f8f9fa; padding: 20px; border-left: 5px solid #764ba2; border-radius: 5px; margin-bottom: 20px; }
        .analysis-card h4 { margin-top: 0; color: #764ba2; display: flex; align-items: center; }
        .tag { display: inline-block; background: #e1e5ea; padding: 2px 8px; border-radius: 12px; font-size: 12px; margin-right: 5px; color: #555; }
    </style>
</head>
<body>

<div class="container">
    <h1>ğŸ”® å…«å­—å‘½ç›¤ Pro</h1>
    
    <div class="input-group">
        <label>å‡ºç”Ÿæ—¥æœŸ (åœ‹æ›†)</label>
        <input type="date" id="birthDate">
    </div>
    
    <div class="input-group">
        <label>å‡ºç”Ÿæ™‚é–“</label>
        <input type="time" id="birthTime" value="12:00">
    </div>

    <button onclick="calculateBazi()">æŸ¥çœ‹å‘½ç›¤èˆ‡è§£æ</button>

    <div id="result" class="result-box">
        <hr style="border: 0; border-top: 1px solid #eee; margin: 25px 0;">
        <h2>ğŸ—“ï¸ æ‚¨çš„å…«å­—å‘½ç›¤</h2>
        
        <table class="chart-table">
            <thead>
                <tr>
                    <th>å¹´æŸ± (ç¥–ä¸Š/å¤–åœ¨)</th>
                    <th>æœˆæŸ± (çˆ¶æ¯/äº‹æ¥­)</th>
                    <th>æ—¥æŸ± (è‡ªå·±/é…å¶)</th>
                    <th>æ™‚æŸ± (å­å¥³/æ™šå¹´)</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><span id="yearGod" class="god-label"></span></td>
                    <td><span id="monthGod" class="god-label"></span></td>
                    <td><span class="god-label">å…ƒç¥</span></td>
                    <td><span id="hourGod" class="god-label"></span></td>
                </tr>
                <tr>
                    <td id="yearGan"></td>
                    <td id="monthGan"></td>
                    <td id="dayGan" class="day-master-bg"></td>
                    <td id="hourGan"></td>
                </tr>
                <tr>
                    <td id="yearZhi"></td>
                    <td id="monthZhi"></td>
                    <td id="dayZhi" class="day-master-bg"></td>
                    <td id="hourZhi"></td>
                </tr>
                <tr>
                    <td><span id="yearZhiGod" class="god-label"></span></td>
                    <td><span id="monthZhiGod" class="god-label"></span></td>
                    <td><span id="dayZhiGod" class="god-label"></span></td>
                    <td><span id="hourZhiGod" class="god-label"></span></td>
                </tr>
            </tbody>
        </table>

        <div class="analysis-card">
            <h4>ğŸ‘¤ æœ¬å‘½æ€§æ ¼ (æ—¥ä¸»)</h4>
            <p><strong>æ‚¨çš„æ ¸å¿ƒæœ¬è³ªï¼š</strong> <span id="dayMasterDesc"></span></p>
            <p id="personalityText"></p>
        </div>

        <div class="analysis-card">
            <h4>ğŸ’¼ è¡Œäº‹é¢¨æ ¼ (æœˆæ”¯åç¥æ ¼å±€)</h4>
            <p><strong>æ‚¨çš„æ ¼å±€å‚¾å‘ï¼š</strong> <span id="patternType"></span></p>
            <p id="patternDesc"></p>
        </div>
        
        <div class="analysis-card">
            <h4>ğŸ’¡ åç¥è§£é‡‹å°è²¼å£«</h4>
            <div style="font-size: 14px; color: #666;">
                <p><span class="tag">æ¯”è‚©/åŠ«è²¡</span> ä»£è¡¨æœ‹å‹ã€ç«¶çˆ­ã€è‡ªå°Šå¿ƒã€‚</p>
                <p><span class="tag">é£Ÿç¥/å‚·å®˜</span> ä»£è¡¨æ‰è¯ã€è¡¨é”ã€å‰µæ„ã€äº«æ¨‚ã€‚</p>
                <p><span class="tag">æ­£è²¡/åè²¡</span> ä»£è¡¨é‡‘éŒ¢ã€ç‰©è³ªã€æ§åˆ¶æ…¾ã€ç¾å¯¦ã€‚</p>
                <p><span class="tag">æ­£å®˜/ä¸ƒæ®º</span> ä»£è¡¨åœ°ä½ã€å£“åŠ›ã€è²¬ä»»ã€è¡Œå‹•åŠ›ã€‚</p>
                <p><span class="tag">æ­£å°/åå°</span> ä»£è¡¨æ€è€ƒã€é•·è¼©ã€å­¸ç¿’ã€å®‰å…¨æ„Ÿã€‚</p>
            </div>
        </div>
    </div>
</div>

<script>
    // äº”è¡Œé¡è‰²æ˜ å°„
    const getElementClass = (char) => {
        const mapping = {
            'ç”²': 'wood', 'ä¹™': 'wood', 'å¯…': 'wood', 'å¯': 'wood',
            'ä¸™': 'fire', 'ä¸': 'fire', 'å·³': 'fire', 'åˆ': 'fire',
            'æˆŠ': 'earth', 'å·±': 'earth', 'è¾°': 'earth', 'æˆŒ': 'earth', 'ä¸‘': 'earth', 'æœª': 'earth',
            'åºš': 'metal', 'è¾›': 'metal', 'ç”³': 'metal', 'é…‰': 'metal',
            'å£¬': 'water', 'ç™¸': 'water', 'äº¥': 'water', 'å­': 'water'
        };
        return mapping[char] || '';
    };

    const renderChar = (char) => `<span class="gan-zhi ${getElementClass(char)}">${char}</span>`;

    // æ—¥ä¸»å€‹æ€§åº«
    const personalities = {
        'ç”²': 'æ“æœ‰å¤§æ¨¹èˆ¬çš„ç‰¹è³ªï¼Œæ­£ç›´ã€ä»æ…ˆä¸”å‘ä¸Šç”Ÿé•·ã€‚æ‚¨ä¸å–œæ­¡è¢«å±ˆæœï¼Œæœ‰é ˜è¢–é¢¨ç¯„ï¼Œä½†æœ‰æ™‚è¼ƒç‚ºå›ºåŸ·ï¼Œéœ€è¦å­¸æœƒèƒ½å±ˆèƒ½ä¼¸ã€‚',
        'ä¹™': 'æ“æœ‰èŠ±è‰èˆ¬çš„éŸŒæ€§ï¼Œé©æ‡‰åŠ›å¼·ï¼Œèº«æ®µæŸ”è»Ÿã€‚æ‚¨å–„æ–¼äº¤éš›ï¼Œå¿ƒæ€ç´°è†©ï¼Œé›–ç„¶å¤–è¡¨çœ‹ä¼¼æŸ”å¼±ï¼Œå…§åœ¨ç”Ÿå‘½åŠ›å»æ¥µå¼·ã€‚',
        'ä¸™': 'åƒå¤ªé™½ä¸€æ¨£ç†±æƒ…é–‹æœ—ï¼Œä¸æ‹˜å°ç¯€ã€‚æ‚¨æ¨‚æ–¼åŠ©äººï¼Œè—ä¸ä½è©±ï¼Œæƒ…ç·’ä¾†å¾—å¿«å»å¾—ä¹Ÿå¿«ï¼Œæ˜¯åœ˜é«”ä¸­çš„é–‹å¿ƒæœï¼Œä½†è¦æ³¨æ„è„¾æ°£ã€‚',
        'ä¸': 'åƒç‡­ç«èˆ¬æº«æš–ï¼Œå¿ƒæ€ç¸å¯†ä¸”æ•æ„Ÿã€‚æ‚¨å¤–è¡¨æ²ˆç©©ï¼Œå…§å¿ƒå……æ»¿ç†±æƒ…ï¼Œå…·æœ‰çŠ§ç‰²å¥‰ç»çš„ç²¾ç¥ï¼Œæ´å¯ŸåŠ›å¼·ï¼Œé©åˆç²¾ç´°çš„å·¥ä½œã€‚',
        'æˆŠ': 'åƒé«˜å±±ä¸€æ¨£ç©©é‡åšå¯¦ï¼Œè¬›ä¿¡ç”¨ã€‚æ‚¨çµ¦äººå®‰å…¨æ„Ÿï¼Œåšäº‹æŒ‰éƒ¨å°±ç­ï¼Œä¸å–œæ­¡è®Šå‹•ï¼Œä½†æœ‰æ™‚æœƒé¡¯å¾—åæ‡‰è¼ƒæ…¢æˆ–éæ–¼å›ºåŸ·ã€‚',
        'å·±': 'åƒç”°åœ’ä¹‹åœŸï¼ŒåŒ…å®¹åŠ›å¼·ï¼Œå¤šæ‰å¤šè—ã€‚æ‚¨å…§æ–‚è¬¹æ…ï¼Œèƒ½å­•è‚²è¬ç‰©ï¼Œå­¸ç¿’èƒ½åŠ›ä½³ï¼Œä½†æœ‰æ™‚æœƒå„ªæŸ”å¯¡æ–·ï¼Œç¼ºé»è‡ªä¿¡ã€‚',
        'åºš': 'åƒåˆ€åŠä¸€æ¨£å‰›æ¯…æœæ–·ï¼Œè¬›ç¾©æ°£ã€‚æ‚¨æ˜¯éåˆ†æ˜ï¼ŒåŸ·è¡ŒåŠ›å¼·ï¼Œä¸å–œæ­¡æ‹–æ³¥å¸¶æ°´ï¼Œä½†ç›´ç‡çš„å€‹æ€§å®¹æ˜“ç„¡æ„é–“å¾—ç½ªäººã€‚',
        'è¾›': 'åƒç å¯¶ä¸€æ¨£ç²¾ç·»ï¼Œé‡è¦–é¢å­èˆ‡è³ªæ„Ÿã€‚æ‚¨æ„Ÿå—åŠ›æ•éŠ³ï¼Œå£æ‰ä½³ï¼Œæœ‰ç¨ç‰¹çš„å¯©ç¾è§€ï¼Œä½†å…§å¿ƒè¼ƒè„†å¼±ï¼Œéœ€è¦ä»–äººçš„è‚¯å®šã€‚',
        'å£¬': 'åƒå¤§æµ·ä¸€æ¨£å¥”æ”¾ï¼Œè°æ˜ä¸”åæ‡‰å¿«ã€‚æ‚¨ä¸å–œæ­¡å—æ‹˜æŸï¼Œé©æ‡‰åŠ›æ¥µå¼·ï¼Œäººè„ˆå»£é—Šï¼Œä½†æœ‰æ™‚æµå‹•æ€§å¤ªå¤§ï¼Œè®“äººæ‰æ‘¸ä¸å®šã€‚',
        'ç™¸': 'åƒé›¨éœ²ä¸€æ¨£æº«æŸ”ï¼Œå…§å‘ä¸”å¯Œæƒ³åƒåŠ›ã€‚æ‚¨å¿ƒæ€ç´°è†©ï¼Œç›´è¦ºæ•éŠ³ï¼Œå–„æ–¼è§€å¯Ÿäººå¿ƒï¼Œä½†å®¹æ˜“æƒ³å¤ªå¤šè€Œé™·å…¥æƒ…ç·’ä½æ½®ã€‚'
    };

    // åç¥æ ¼å±€è§£é‡‹ (å–æœˆæ”¯ä¸»æ°£)
    const godPatterns = {
        'æ¯”è‚©': 'å»ºç¥¿æ ¼/æ¯”è‚©å¼·ï¼šæ‚¨è‡ªå°Šå¿ƒå¼·ï¼Œç¨ç«‹è‡ªä¸»ï¼Œä¸å–œæ­¡ä¾è³´ä»–äººã€‚æ¯”èµ·å—åƒ±æ–¼äººï¼Œæ‚¨æ›´æ¸´æœ›æ“æœ‰è‡ªå·±çš„äº‹æ¥­æˆ–èˆå°ï¼Œå°æœ‹å‹è¬›ç¾©æ°£ï¼Œä½†å®¹æ˜“ç ´è²¡ã€‚',
        'åŠ«è²¡': 'ç¾Šåˆƒ/åŠ«è²¡å¼·ï¼šæ‚¨é‡å¿ƒå‹ƒå‹ƒï¼Œç«¶çˆ­å¿ƒå¼·ï¼Œå…·æœ‰å¾ˆå¼·çš„åŸ·è¡ŒåŠ›èˆ‡ç¤¾äº¤æ‰‹è…•ã€‚æ‚¨çš„æ€§æ ¼å¤–å‘ï¼Œä½†å…§å¿ƒå¸¸æœ‰çŸ›ç›¾ï¼Œåœ¨é‡‘éŒ¢ç®¡ç†ä¸Šéœ€ç‰¹åˆ¥æ³¨æ„å¤§é€²å¤§å‡ºã€‚',
        'é£Ÿç¥': 'é£Ÿç¥æ ¼ï¼šæ‚¨æ€§æƒ…æº«å’Œï¼Œé‡è¦–ç”Ÿæ´»å“è³ªèˆ‡äº«å—ï¼Œé€šå¸¸å¾ˆæœ‰å£ç¦ã€‚æ‚¨è°æ˜ä¸”æœ‰æ‰è¯ï¼Œä¸å–œæ­¡èˆ‡äººçˆ­é¬¥ï¼Œé©åˆå¾äº‹éœ€è¦å‰µæ„æˆ–å°ˆæ¥­æŠ€èƒ½çš„é ˜åŸŸã€‚',
        'å‚·å®˜': 'å‚·å®˜æ ¼ï¼šæ‚¨æ‰æ€æ•æ·ï¼Œå›é€†å¿ƒå¼·ï¼Œè¨å­å‚³çµ±æŸç¸›ã€‚æ‚¨çš„è¡¨é”èƒ½åŠ›æ¥µä½³ï¼Œç”šè‡³æœ‰é»æ¯’èˆŒï¼Œé©åˆå¾äº‹æ¼”è—ã€è¨­è¨ˆæˆ–æ‰“ç ´å¸¸è¦çš„å‰µæ–°å·¥ä½œã€‚',
        'æ­£è²¡': 'æ­£è²¡æ ¼ï¼šæ‚¨å€‹æ€§å‹™å¯¦ï¼Œé‡è¦–å‹¤å‹è‡´å¯Œã€‚æ‚¨åšäº‹è¬¹æ…å°å¿ƒï¼Œé‡è¦–å®¶åº­è²¬ä»»ï¼Œä¸å–œæ­¡é«˜é¢¨éšªçš„æŠ•æ©Ÿï¼Œæ˜¯æ¨™æº–çš„ç†è²¡å¥½æ‰‹èˆ‡å¥½å“¡å·¥ã€‚',
        'åè²¡': 'åè²¡æ ¼ï¼šæ‚¨æ…·æ…¨è±ªçˆ½ï¼Œé‡‘éŒ¢è§€å¿µéˆæ´»ã€‚æ‚¨å–„æ–¼äº¤éš›ï¼Œçœ¼å…‰ç¨åˆ°ï¼Œå–œæ­¡è³ºå–æµå‹•ä¹‹è²¡æˆ–æŠ•è³‡ï¼Œä¸å–œæ­¡æ­»å®ˆå›ºå®šçš„è–ªæ°´ï¼Œå¾ˆæœ‰å•†æ¥­é ­è…¦ã€‚',
        'æ­£å®˜': 'æ­£å®˜æ ¼ï¼šæ‚¨ç‚ºäººæ­£ç›´ï¼Œé‡è¦–ç´€å¾‹èˆ‡åè­½ã€‚æ‚¨åšäº‹å…‰æ˜ç£Šè½ï¼Œæœ‰è²¬ä»»æ„Ÿï¼Œé©åˆåœ¨å¤§å‹æ©Ÿæ§‹æˆ–å…¬è·ç™¼å±•ï¼Œæ˜¯å…¸å‹çš„ç®¡ç†è€…äººæ‰ã€‚',
        'ä¸ƒæ®º': 'ä¸ƒæ®ºæ ¼ï¼šæ‚¨å…·æœ‰æ¬Šå¨æ„Ÿï¼Œè¡Œäº‹æœæ±ºï¼Œç”šè‡³æœ‰é»éœ¸æ°£ã€‚æ‚¨ä¸ç•è‰±é›£ï¼Œå–œæ­¡æŒ‘æˆ°é«˜é›£åº¦çš„ä»»å‹™ï¼Œåœ¨æ··äº‚çš„ç’°å¢ƒä¸­æ›´èƒ½å±•ç¾æ‚¨çš„é ˜å°èƒ½åŠ›ã€‚',
        'æ­£å°': 'æ­£å°æ ¼ï¼šæ‚¨å¿ƒåœ°å–„è‰¯ï¼Œé‡è¦–ç²¾ç¥å±¤é¢çš„æ»¿è¶³ã€‚æ‚¨é€šå¸¸å¾ˆæœ‰é•·è¼©ç·£ï¼Œå–œæ­¡å­¸ç¿’èˆ‡æ€è€ƒï¼Œå€‹æ€§è¼ƒç‚ºä¿å®ˆå®‰éœï¼Œé©åˆæ•™è‚²æˆ–å­¸è¡“ç ”ç©¶ã€‚',
        'åå°': 'åå°æ ¼ï¼šæ‚¨æ€è€ƒç¨ç‰¹ï¼Œç›´è¦ºæ•éŠ³ï¼Œä¸å–œæ­¡éš¨æ³¢é€æµã€‚æ‚¨åœ¨ç‰¹æ®Šé ˜åŸŸæˆ–å†·é–€å­¸å•ä¸Šå®¹æ˜“æœ‰éäººçš„é ˜æ‚ŸåŠ›ï¼Œå€‹æ€§è¼ƒç‚ºå­¤åƒ»é«˜å†·ã€‚'
    };

    function calculateBazi() {
        const dateInput = document.getElementById('birthDate').value;
        const timeInput = document.getElementById('birthTime').value;

        if (!dateInput || !timeInput) {
            alert('è«‹è¼¸å…¥å®Œæ•´çš„å‡ºç”Ÿæ—¥æœŸèˆ‡æ™‚é–“');
            return;
        }

        const [year, month, day] = dateInput.split('-').map(Number);
        const [hour, minute] = timeInput.split(':').map(Number);

        // å»ºç«‹ Solar å’Œ Lunar å°è±¡
        const solar = Solar.fromYmdHms(year, month, day, hour, minute, 0);
        const lunar = solar.getLunar();
        const baZi = lunar.getEightChar();

        // ç²å–å››æŸ±
        document.getElementById('result').style.display = 'block';
        
        // æ¸²æŸ“å¤©å¹²åœ°æ”¯
        document.getElementById('yearGan').innerHTML = renderChar(baZi.getYearGan());
        document.getElementById('yearZhi').innerHTML = renderChar(baZi.getYearZhi());
        document.getElementById('monthGan').innerHTML = renderChar(baZi.getMonthGan());
        document.getElementById('monthZhi').innerHTML = renderChar(baZi.getMonthZhi());
        document.getElementById('dayGan').innerHTML = renderChar(baZi.getDayGan());
        document.getElementById('dayZhi').innerHTML = renderChar(baZi.getDayZhi());
        document.getElementById('hourGan').innerHTML = renderChar(baZi.getTimeGan());
        document.getElementById('hourZhi').innerHTML = renderChar(baZi.getTimeZhi());

        // ç²å–åç¥ (lunar.js å…§å»ºæ–¹æ³•)
        document.getElementById('yearGod').innerText = baZi.getYearShiShenGan();
        document.getElementById('monthGod').innerText = baZi.getMonthShiShenGan();
        document.getElementById('hourGod').innerText = baZi.getTimeShiShenGan();

        // åœ°æ”¯è—å¹²åç¥ (é€™è£¡å–æœ¬æ°£/ä¸»æ°£ä¾†ç°¡åŒ–é¡¯ç¤º)
        // æ³¨æ„ï¼šlunar.js çš„ getYearShiShenZhi() å›å‚³çš„æ˜¯ä¸€å€‹é™£åˆ—(åŒ…å«æ‰€æœ‰è—å¹²)ï¼Œæˆ‘å€‘å–ç¬¬ä¸€å€‹é€šå¸¸ç‚ºä¸»æ°£
        document.getElementById('yearZhiGod').innerText = baZi.getYearShiShenZhi()[0];
        document.getElementById('monthZhiGod').innerText = baZi.getMonthShiShenZhi()[0];
        document.getElementById('dayZhiGod').innerText = baZi.getDayShiShenZhi()[0];
        document.getElementById('hourZhiGod').innerText = baZi.getTimeShiShenZhi()[0];

        // 1. æ—¥ä¸»è§£æ
        const dayGan = baZi.getDayGan();
        document.getElementById('dayMasterDesc').innerText = `${dayGan} (${getElementClass(dayGan) === 'wood' ? 'æœ¨' : getElementClass(dayGan) === 'fire' ? 'ç«' : getElementClass(dayGan) === 'earth' ? 'åœŸ' : getElementClass(dayGan) === 'metal' ? 'é‡‘' : 'æ°´'})`;
        document.getElementById('personalityText').innerText = personalities[dayGan];

        // 2. æ ¼å±€è§£æ (ç°¡å–®æ³•ï¼šå–æœˆä»¤ä¸»æ°£åç¥)
        const patternGod = baZi.getMonthShiShenZhi()[0]; // æœˆæ”¯ä¸»æ°£åç¥
        document.getElementById('patternType').innerText = patternGod;
        document.getElementById('patternDesc').innerText = godPatterns[patternGod] || 'æ ¼å±€è¼ƒç‚ºè¤‡é›œï¼Œèåˆäº†å¤šç¨®ç‰¹è³ªã€‚';
    }
</script>

</body>
</html>