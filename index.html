<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç°¡æ˜“å…«å­—æ’ç›¤èˆ‡å€‹æ€§è§£æ</title>
    <script src="https://cdn.jsdelivr.net/npm/lunar-javascript@1.6.12/lunar.js"></script>
    <style>
        body { font-family: "Microsoft JhengHei", Arial, sans-serif; background-color: #f4f7f6; display: flex; justify-content: center; padding: 20px; }
        .container { background: white; padding: 30px; border-radius: 15px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); width: 100%; max-width: 600px; }
        h1 { text-align: center; color: #333; }
        .input-group { margin-bottom: 15px; }
        label { display: block; margin-bottom: 5px; font-weight: bold; }
        input, select { width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px; box-sizing: border-box; }
        button { width: 100%; padding: 12px; background-color: #8e44ad; color: white; border: none; border-radius: 5px; font-size: 16px; cursor: pointer; transition: 0.3s; }
        button:hover { background-color: #732d91; }
        
        .result-box { margin-top: 30px; display: none; }
        .chart-table { width: 100%; border-collapse: collapse; margin-bottom: 20px; text-align: center; }
        .chart-table th { background: #eee; padding: 10px; }
        .chart-table td { border: 1px solid #ddd; padding: 15px; font-size: 18px; font-weight: bold; }
        
        /* äº”è¡Œé¡è‰²æ¨™ç¤º */
        .wood { color: green; }
        .fire { color: red; }
        .earth { color: #8B4513; }
        .metal { color: #DAA520; }
        .water { color: blue; }

        .analysis { background: #f9f9f9; padding: 20px; border-left: 5px solid #8e44ad; border-radius: 5px; }
        .analysis h3 { margin-top: 0; }
        .analysis p { line-height: 1.6; color: #555; }
    </style>
</head>
<body>

<div class="container">
    <h1>ğŸ”® å…«å­—å‘½ç›¤æŸ¥è©¢</h1>
    
    <div class="input-group">
        <label>å‡ºç”Ÿæ—¥æœŸ (åœ‹æ›†/è¥¿å…ƒ)</label>
        <input type="date" id="birthDate">
    </div>
    
    <div class="input-group">
        <label>å‡ºç”Ÿæ™‚é–“</label>
        <input type="time" id="birthTime" value="12:00">
    </div>

    <div class="input-group">
        <label>æ€§åˆ¥</label>
        <select id="gender">
            <option value="1">ç”·</option>
            <option value="0">å¥³</option>
        </select>
    </div>

    <button onclick="calculateBazi()">é–‹å§‹æ’ç›¤</button>

    <div id="result" class="result-box">
        <hr>
        <h2>ğŸ—“ï¸ æ‚¨çš„å…«å­—å‘½ç›¤</h2>
        <table class="chart-table">
            <thead>
                <tr>
                    <th>å¹´æŸ±</th>
                    <th>æœˆæŸ±</th>
                    <th>æ—¥æŸ± (å…ƒç¥)</th>
                    <th>æ™‚æŸ±</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td id="yearPillar"></td>
                    <td id="monthPillar"></td>
                    <td id="dayPillar" style="background-color: #fff3cd;"></td>
                    <td id="hourPillar"></td>
                </tr>
            </tbody>
        </table>

        <div class="analysis">
            <h3>ğŸ“– å€‹æ€§è§£æ</h3>
            <p><strong>æ‚¨çš„æ—¥ä¸»ï¼ˆå…ƒç¥ï¼‰ï¼š</strong> <span id="dayMasterName"></span></p>
            <p id="personalityText">è«‹è¼¸å…¥ç”Ÿæ—¥ä»¥ç²å–è§£æã€‚</p>
        </div>
    </div>
</div>

<script>
    // å®šç¾©äº”è¡Œå°æ‡‰çš„ CSS classï¼Œç”¨æ–¼ä¸Šè‰²
    const getElementClass = (char) => {
        const wuxing = Solar.fromYmd(2000,1,1).getLuozhou(); // å€Ÿç”¨åº«è£¡çš„äº”è¡ŒæŸ¥æ‰¾ï¼Œæˆ–è€…æ‰‹å¯«æ˜ å°„
        // ç°¡å–®æ‰‹å¯«æ˜ å°„
        const mapping = {
            'ç”²': 'wood', 'ä¹™': 'wood', 'å¯…': 'wood', 'å¯': 'wood',
            'ä¸™': 'fire', 'ä¸': 'fire', 'å·³': 'fire', 'åˆ': 'fire',
            'æˆŠ': 'earth', 'å·±': 'earth', 'è¾°': 'earth', 'æˆŒ': 'earth', 'ä¸‘': 'earth', 'æœª': 'earth',
            'åºš': 'metal', 'è¾›': 'metal', 'ç”³': 'metal', 'é…‰': 'metal',
            'å£¬': 'water', 'ç™¸': 'water', 'äº¥': 'water', 'å­': 'water'
        };
        return mapping[char] || '';
    };

    // åŠ ä¸Šé¡è‰²çš„ HTML åŒ…è£å™¨
    const colorize = (text) => {
        let gan = text.substring(0, 1);
        let zhi = text.substring(1, 2);
        return `<span class="${getElementClass(gan)}">${gan}</span><span class="${getElementClass(zhi)}">${zhi}</span>`;
    };

    // å€‹æ€§è§£æè³‡æ–™åº« (åŸºæ–¼æ—¥å¹²/æ—¥ä¸»)
    const personalities = {
        'ç”²': 'æ‚¨å±¬æ–¼ã€Œç”²æœ¨ã€äººã€‚å€‹æ€§æ­£ç›´ã€ä»æ…ˆã€æœ‰ä¸Šé€²å¿ƒã€‚åƒå¤§æ¨¹ä¸€æ¨£ï¼Œæ‚¨æ¸´æœ›æˆé•·ä¸¦æˆç‚ºæ£Ÿæ¨‘ï¼Œä¸å–œæ­¡è¢«æ‹˜æŸã€‚é›–ç„¶å¤–è¡¨çœ‹ä¼¼å …å¼·ï¼Œä½†å…§å¿ƒæœ‰æ™‚è¼ƒç‚ºå›ºåŸ·ï¼Œé€™ä»½å …æŒè®“æ‚¨åœ¨äº‹æ¥­ä¸Šå®¹æ˜“ç²å¾—æˆå°±ï¼Œä½†ä¹Ÿéœ€æ³¨æ„èº«æ®µè¦æŸ”è»Ÿä¸€äº›ã€‚',
        'ä¹™': 'æ‚¨å±¬æ–¼ã€Œä¹™æœ¨ã€äººã€‚å€‹æ€§æº«æŸ”ã€é©æ‡‰åŠ›å¼·ã€å¿ƒæ€ç´°è†©ã€‚åƒèŠ±è‰è—¤è”“ä¸€æ¨£ï¼Œæ‚¨æ‡‚å¾—åœ¨ä¸åŒç’°å¢ƒä¸­ç”Ÿå­˜ï¼Œèº«æ®µæŸ”è»Ÿï¼Œå–„æ–¼äº¤éš›ã€‚é›–ç„¶ä¸åƒå¤§æ¨¹èˆ¬å‰›å¼·ï¼Œä½†æ‚¨çš„éŸŒæ€§æ¥µå¼·ï¼Œé€™ä»½ã€Œä»¥æŸ”å…‹å‰›ã€çš„ç‰¹è³ªæ˜¯æ‚¨æœ€å¤§çš„æ­¦å™¨ã€‚',
        'ä¸™': 'æ‚¨å±¬æ–¼ã€Œä¸™ç«ã€äººã€‚å€‹æ€§ç†±æƒ…ã€é–‹æœ—ã€å……æ»¿æ´»åŠ›ã€‚åƒå¤ªé™½ä¸€æ¨£ï¼Œæ‚¨å–œæ­¡ç…§é¡§åˆ¥äººï¼Œä¸æ‹˜å°ç¯€ï¼Œè—ä¸ä½è©±ã€‚æ‚¨çš„å‡ºç¾ç¸½èƒ½å¸¶çµ¦å‘¨åœæº«æš–ï¼Œä½†æœ‰æ™‚å› éæ–¼æ€¥èºæˆ–æƒ…ç·’èµ·ä¼å¤§ï¼Œå®¹æ˜“ç„¡å¿ƒå‚·äººï¼Œå­¸ç¿’å†·éœæ˜¯æ‚¨çš„èª²é¡Œã€‚',
        'ä¸': 'æ‚¨å±¬æ–¼ã€Œä¸ç«ã€äººã€‚å€‹æ€§æº«å’Œã€æœ‰ç¦®ã€å¿ƒæ€ç¸å¯†ã€‚åƒç‡­å…‰æˆ–ç‡ˆç«ï¼Œé›–ç„¶ä¸åˆºçœ¼ï¼Œä½†å…·æœ‰çŠ§ç‰²å¥‰ç»çš„ç²¾ç¥ã€‚æ‚¨å¤–è¡¨æ²ˆç©©ï¼Œå…§å¿ƒå»å……æ»¿ç†±æƒ…ï¼Œå°æ–¼ç´°ç¯€è§€å¯Ÿå…¥å¾®ã€‚æœ‰æ™‚å®¹æ˜“å¤šæ„å–„æ„Ÿï¼Œä¿æŒå…§å¿ƒçš„ç©©å®šå°æ‚¨å¾ˆé‡è¦ã€‚',
        'æˆŠ': 'æ‚¨å±¬æ–¼ã€ŒæˆŠåœŸã€äººã€‚å€‹æ€§ç©©é‡ã€ä¿¡å¯¦ã€åŒ…å®¹åŠ›å¼·ã€‚åƒé«˜å±±æˆ–å¤§åœ°ï¼Œæ‚¨çµ¦äººä¸€ç¨®å¯é çš„å®‰å…¨æ„Ÿï¼Œåšäº‹æŒ‰éƒ¨å°±ç­ï¼Œä¸å–œæ­¡è®Šå‹•ã€‚é›–ç„¶æœ‰æ™‚é¡¯å¾—å›ºåŸ·æˆ–åæ‡‰è¼ƒæ…¢ï¼Œä½†æ‚¨çš„èª ä¿¡å’Œæ¯…åŠ›æ˜¯æœ‹å‹å’Œåˆä½œå¤¥ä¼´æœ€ä¿¡è³´çš„ç‰¹è³ªã€‚',
        'å·±': 'æ‚¨å±¬æ–¼ã€Œå·±åœŸã€äººã€‚å€‹æ€§å¤šæ‰å¤šè—ã€å…§æ–‚ã€æœ‰åŒ…å®¹å¿ƒã€‚åƒç”°åœ’ä¹‹åœŸï¼Œæ‚¨å…·æœ‰å­•è‚²è¬ç‰©çš„èƒ½åŠ›ï¼Œå­¸ç¿’èƒ½åŠ›å¼·ï¼Œä¸”èƒ½å±ˆèƒ½ä¼¸ã€‚æ‚¨åšäº‹è¬¹æ…ï¼Œä¸å–œæ­¡å‡ºé¢¨é ­ï¼Œä½†å…§å¿ƒå¾ˆæœ‰æƒ³æ³•ã€‚å¶çˆ¾æœƒå„ªæŸ”å¯¡æ–·ï¼Œéœ€è¦æ›´å¤šçš„è‡ªä¿¡ä¾†åšæ±ºå®šã€‚',
        'åºš': 'æ‚¨å±¬æ–¼ã€Œåºšé‡‘ã€äººã€‚å€‹æ€§å‰›æ¯…ã€æœæ–·ã€è¬›ç¾©æ°£ã€‚åƒåˆ€åŠæˆ–ç¤¦çŸ³ï¼Œæ‚¨æ˜¯éåˆ†æ˜ï¼Œä¸å–œæ­¡æ‹–æ³¥å¸¶æ°´ã€‚æ‚¨å…·æœ‰å¾ˆå¼·çš„åŸ·è¡ŒåŠ›å’Œé ˜å°é¢¨ç¯„ï¼Œç‚ºäº†æœ‹å‹é¡˜æ„å…©è‚‹æ’åˆ€ã€‚ä½†æœ‰æ™‚éæ–¼ç›´ç‡å‰›ç¡¬ï¼Œå®¹æ˜“å¾—ç½ªäººï¼Œéœ€å­¸ç¿’åœ“èçš„æ™ºæ…§ã€‚',
        'è¾›': 'æ‚¨å±¬æ–¼ã€Œè¾›é‡‘ã€äººã€‚å€‹æ€§ç´°è†©ã€å„ªé›…ã€é‡è¦–é¢å­ã€‚åƒç å¯¶é¦–é£¾ï¼Œæ‚¨å–œæ­¡å±•ç¾ç¾å¥½çš„ä¸€é¢ï¼Œè‡ªå°Šå¿ƒå¼·ï¼Œæ„Ÿå—åŠ›æ•éŠ³ã€‚æ‚¨çš„å£æ‰é€šå¸¸ä¸éŒ¯ï¼Œä¹Ÿå¾ˆæœ‰å¯©ç¾çœ¼å…‰ã€‚å› ç‚ºå…§å¿ƒæŸ”è»Ÿæ•æ„Ÿï¼Œå®¹æ˜“å—å‚·ï¼Œéœ€è¦ä»–äººçš„è‚¯å®šèˆ‡è®šç¾ã€‚',
        'å£¬': 'æ‚¨å±¬æ–¼ã€Œå£¬æ°´ã€äººã€‚å€‹æ€§è°æ˜ã€è±ªçˆ½ã€é©æ‡‰åŠ›æ¥µå¼·ã€‚åƒæ±Ÿæ²³å¤§æµ·ï¼Œæ‚¨çš„æ€ç¶­æ´»èºï¼Œä¸å–œæ­¡è¢«æ¡†æ¶é™åˆ¶ï¼Œå……æ»¿æ™ºæ…§èˆ‡è¡å‹ã€‚æ‚¨çš„äººéš›é—œä¿‚é€šå¸¸ä¸éŒ¯ï¼Œä½†ä¹Ÿå› ç‚ºæµå‹•æ€§å¤§ï¼Œæœ‰æ™‚è®“äººæ‰æ‘¸ä¸å®šï¼Œå­¸ç¿’å°ˆæ³¨èˆ‡å®šæ€§æœƒè®“æˆå°±æ›´é«˜ã€‚',
        'ç™¸': 'æ‚¨å±¬æ–¼ã€Œç™¸æ°´ã€äººã€‚å€‹æ€§å…§å‘ã€æº«æŸ”ã€æƒ³åƒåŠ›è±å¯Œã€‚åƒé›¨éœ²æˆ–å°æºªï¼Œæ‚¨å¿ƒæ€ç´°è†©ï¼Œå–„æ–¼å¯Ÿè¨€è§€è‰²ï¼Œå…·æœ‰å¾ˆå¼·çš„ç›´è¦ºåŠ›ã€‚æ‚¨å¤–è¡¨çœ‹ä¼¼å¹³éœï¼Œå…§å¿ƒå»æƒ…æ„Ÿè±å¯Œã€‚æœ‰æ™‚å®¹æ˜“æƒ³å¤ªå¤šè€Œé™·å…¥æ†‚é¬±ï¼Œé©æ™‚é‡‹æ”¾å£“åŠ›å°æ‚¨å¾ˆæœ‰å¹«åŠ©ã€‚'
    };

    function calculateBazi() {
        const dateInput = document.getElementById('birthDate').value;
        const timeInput = document.getElementById('birthTime').value;

        if (!dateInput || !timeInput) {
            alert('è«‹è¼¸å…¥å®Œæ•´çš„å‡ºç”Ÿæ—¥æœŸèˆ‡æ™‚é–“');
            return;
        }

        // è§£ææ—¥æœŸèˆ‡æ™‚é–“
        const dateParts = dateInput.split('-');
        const timeParts = timeInput.split(':');
        
        const year = parseInt(dateParts[0]);
        const month = parseInt(dateParts[1]);
        const day = parseInt(dateParts[2]);
        const hour = parseInt(timeParts[0]);
        const minute = parseInt(timeParts[1]);

        // ä½¿ç”¨ lunar-javascript å»ºç«‹ Solar å°è±¡
        const solar = Solar.fromYmdHms(year, month, day, hour, minute, 0);
        
        // è½‰æ›ç‚º Lunar (è¾²æ›†) å°è±¡ä»¥ç²å–å…«å­—
        const lunar = solar.getLunar();
        const baZi = lunar.getEightChar();

        // ç²å–å››æŸ± (å¤©å¹²åœ°æ”¯)
        const yearGanZhi = baZi.getYear();
        const monthGanZhi = baZi.getMonth();
        const dayGanZhi = baZi.getDay();
        const timeGanZhi = baZi.getTime();

        // é¡¯ç¤ºçµæœ
        document.getElementById('result').style.display = 'block';
        document.getElementById('yearPillar').innerHTML = colorize(yearGanZhi);
        document.getElementById('monthPillar').innerHTML = colorize(monthGanZhi);
        document.getElementById('dayPillar').innerHTML = colorize(dayGanZhi);
        document.getElementById('hourPillar').innerHTML = colorize(timeGanZhi);

        // è§£æå€‹æ€§ (åŸºæ–¼æ—¥æŸ±å¤©å¹²ï¼Œå³ã€Œæ—¥ä¸»ã€)
        const dayGan = baZi.getDayGan(); // ç²å–æ—¥å¹² (ç”²ã€ä¹™ã€ä¸™...)
        
        document.getElementById('dayMasterName').innerText = `${dayGan} (${getElementClass(dayGan) === 'wood' ? 'æœ¨' : getElementClass(dayGan) === 'fire' ? 'ç«' : getElementClass(dayGan) === 'earth' ? 'åœŸ' : getElementClass(dayGan) === 'metal' ? 'é‡‘' : 'æ°´'})`;
        document.getElementById('personalityText').innerText = personalities[dayGan] || 'ç„¡æ³•è§£æè³‡æ–™';
    }
</script>

</body>
</html>